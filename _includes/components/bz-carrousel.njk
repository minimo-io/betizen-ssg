{# _includes/components/bz-carrousel.njk #}
<div class="carousel-container mt-4">
    <!-- Flickity HTML init -->
    <div class="carousel mx-2 mt-3 mt-md-1 mb-5 Xmb-md-0">
        
        <!-- First cell with nested carousel for multiple featured casinos -->
        <div class="carousel-cell carousel-cell-smaller nested-carousel-wrapper">
            <div class="nested-carousel-container">
                <div class="nested-carousel">
                    <!-- First featured casino -->
                    <a
                        href="{{ languages[page.lang].promo.casino.url }}"
                        target="_blank"
                        class="nested-carousel-cell"
                    >
                        <div
                            class="carousel-image-small"
                            style="background-image: url('{{ languages[page.lang].promo.casino.logo }}');"
                        ></div>
                        <div class="featured-text featured-gold">
                            ðŸ¥‡ {{ languages[page.lang].texts.featured }}
                        </div>
                        <span class="carousel-button featured-gold btn btn-scale">{{ languages[page.lang].texts.visit }}</span>
                    </a>
                    
                    <!-- Add more featured casinos here -->
                    {% if languages[page.lang].promo.casino2 %}
                    <a
                        href="{{ languages[page.lang].promo.casino2.url }}"
                        target="_blank"
                        class="nested-carousel-cell"
                    >
                        <div
                            class="carousel-image-small"
                            style="background-image: url('{{ languages[page.lang].promo.casino2.logo }}');"
                        ></div>
                        <div class="featured-text featured-gold">
                            ðŸ¥‡ {{ languages[page.lang].texts.featured }}
                        </div>
                        <span class="carousel-button featured-gold btn btn-scale">{{ languages[page.lang].texts.visit }}</span>
                    </a>
                    {% endif %}
                    
                    {% if languages[page.lang].promo.casino3 %}
                    <a
                        href="{{ languages[page.lang].promo.casino3.url }}"
                        target="_blank"
                        class="nested-carousel-cell"
                    >
                        <div
                            class="carousel-image-small"
                            style="background-image: url('{{ languages[page.lang].promo.casino3.logo }}');"
                        ></div>
                        <div class="featured-text featured-gold">
                            ðŸ¥‡ {{ languages[page.lang].texts.featured }}
                        </div>
                        <span class="carousel-button featured-gold btn btn-scale">{{ languages[page.lang].texts.visit }}</span>
                    </a>
                    {% endif %}
                </div>
                

            </div>
        </div>

        <a
            href="{{ languages[page.lang].promo.url }}"
            target="_blank"
            rel="nofollow noopener"
            class="carousel-cell carousel-cell-big"
        >
            <div class="carousel-cell-image-overlay"></div>
            <div
                class="carousel-image"
                style="
                    background-image: url('{{ metadata.images.site }}bonus-bg-1.webp');
                "
            ></div>
            <h3 class="carousel-cell-big-title">
                {{ languages[page.lang].promo.cta }}
            </h3>

            <div class="featured-text featured-black">{{ languages[page.lang].texts.bonus }}</div>
            <span class="carousel-button btn btn-scale featured-black">{{ languages[page.lang].texts.tryBonus }}</span>
        </a>
        <a
            href="{{ "/juego/slot-fortune-tiger/" | locale_url }}"
            target="_blank"
            class="carousel-cell carousel-cell-smaller">
            <div
                class="carousel-image-small"
                style="
                    background-image: url('/assets/imgs/games/slot-fortune-tiger-logo.webp');
                "
            ></div>
            <div class="featured-text">
                <i class="fa fa-line-chart mr-1" aria-hidden="true"></i>Popular
            </div>
            <span class="carousel-button btn btn-scale">{{ languages[page.lang].texts.freePlay }}</span>
        </a>           
        <a
            href="{{ "/juego/tragamonedas-jack-y-las-habichuelas-magicas/" | locale_url }}"
            target="_blank"
            class="carousel-cell carousel-cell-smaller"
        >
            <div
                class="carousel-image-small"
                style="
                    background-image: url('/assets/imgs/games/tragamonedas-jack-y-las-habichuelas-magicas-logo.webp');
                "
            ></div>
            <div class="featured-text">
                <i class="fa fa-line-chart mr-1" aria-hidden="true"></i>Popular
            </div>
            <span class="carousel-button btn btn-scale">{{ languages[page.lang].texts.freePlay }}</span>
        </a>
        <a
            href="{{ "/juego/thunderstruck-ii-video-bingo/" | locale_url }}"
            target="_blank"
            class="carousel-cell carousel-cell-smaller"
        >
            <div
                class="carousel-image-small"
                style="
                    background-image: url('/assets/imgs/games/thunderstruck-ii-video-bingo-logo.webp');
                "
            ></div>
            <div class="featured-text">
                <i class="fa fa-line-chart mr-1" aria-hidden="true"></i>Popular
            </div>
            <span class="carousel-button btn btn-scale">{{ languages[page.lang].texts.freePlay }}</span>
        </a>
        <a
            href="{{ "/juego/conquestera-tragaperras/" | locale_url }}"
            target="_blank"
            class="carousel-cell carousel-cell-smaller"
        >
            <div
                class="carousel-image-small"
                style="
                    background-image: url('/assets/imgs/games/conquestera-tragaperras-logo.webp');
                "
            ></div>
            <div class="featured-text">
                <i class="fa fa-line-chart mr-1" aria-hidden="true"></i>Popular
            </div>
            <span class="carousel-button btn btn-scale">{{ languages[page.lang].texts.freePlay }}</span>
        </a>        
        <a
            href="{{ "/juego/tragamonedas-monopoly-megaways/" | locale_url }}"
            target="_blank"
            class="carousel-cell carousel-cell-smaller"
        >
            <div
                class="carousel-image-small"
                style="
                    background-image: url('/assets/imgs/games/tragamonedas-monopoly-megaways-logo.webp');
                "
            ></div>
            <div class="featured-text">
                <i class="fa fa-line-chart mr-1" aria-hidden="true"></i>Popular
            </div>
            <span class="carousel-button btn btn-scale">{{ languages[page.lang].texts.freePlay }}</span>
        </a>     
    </div>
</div>

<style>
/* Nested carousel styles */
.nested-carousel-container {
    width: 100%;
    height: 100%;
    overflow: hidden;
}

.nested-carousel {
    display: flex;
    transition: transform 0.5s ease;
    width: 100%;
    height: 100%;
}

.nested-carousel-cell {
    min-width: 100%;
    flex-shrink: 0;
    position: relative;
    text-decoration: none;
    color: inherit;
}
</style>

<script>
    var flkty = $(".carousel").flickity({
        cellAlign: "left",
        prevNextButtons: false,
        contain: true,
        wrapAround: false,
        freeScroll: false,
        groupCells: true,
        autoPlay: false,
        pageDots: true,
    });
    flkty.next();

    // Simple nested carousel
    let currentSlide = 0;
    const slides = document.querySelectorAll('.nested-carousel-cell');
    const carousel = document.querySelector('.nested-carousel');
    
    if (slides.length > 1) {
        setInterval(() => {
            currentSlide = (currentSlide + 1) % slides.length;
            carousel.style.transform = `translateX(-${currentSlide * 100}%)`;
        }, 3000);
    }
</script>